<!-- app/views/invoices/show.html.erb -->
<div class="invoice-details">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1>Invoice: <%= sprintf("INV-%05d", @invoice.id) %></h1>
    <div>
      <%= link_to "Edit Invoice", edit_invoice_path(@invoice), class: "btn btn-outline-primary" %>
      <%= link_to "Back to Invoices", invoices_path, class: "btn btn-outline-secondary" %>
    </div>
  </div>

  <div class="row mb-4">
    <div class="col-md-8 offset-md-2">
      <div class="card">
        <div class="card-header">
          <h5 class="mb-0">Invoice Details</h5>
        </div>
        <div class="card-body">
          <div class="row mb-4">
            <div class="col-md-6">
              <p><strong>Client:</strong> <%= @invoice.client_name %></p>
              <p><strong>Invoice #:</strong> <%= sprintf("INV-%05d", @invoice.id) %></p>
            </div>
            <div class="col-md-6 text-md-end">
              <p><strong>Issue Date:</strong> <%= @invoice.issue_date&.strftime('%Y-%m-%d') %></p>
              <p><strong>Due Date:</strong> <%= @invoice.due_date&.strftime('%Y-%m-%d') %></p>
            </div>
          </div>

          <div class="table-responsive mb-4">
            <table class="table table-bordered">
              <thead class="table-light">
              <tr>
                <th>Description</th>
                <th class="text-end">Amount</th>
              </tr>
              </thead>
              <tbody>
              <tr>
                <td>Invoice Amount</td>
                <td class="text-end"><%= number_to_currency(@invoice.amount) %></td>
              </tr>
              </tbody>
              <tfoot>
              <tr>
                <th>Total</th>
                <th class="text-end"><%= number_to_currency(@invoice.amount) %></th>
              </tr>
              </tfoot>
            </table>
          </div>

          <div class="row mb-4">
            <div class="col-md-6">
              <p><strong>Status:</strong>
                <% if @invoice.status == 'pending' %>
                  <span class="badge bg-warning">Pending</span>
                  <% if @invoice.due_date && @invoice.due_date < Date.today %>
                    <span class="badge bg-danger">Overdue</span>
                  <% end %>
                <% elsif @invoice.status == 'paid' %>
                  <span class="badge bg-success">Paid</span>
                <% elsif @invoice.status == 'cancelled' %>
                  <span class="badge bg-danger">Cancelled</span>
                <% else %>
                  <span class="badge bg-secondary"><%= @invoice.status.titleize %></span>
                <% end %>
              </p>
            </div>
            <div class="col-md-6 text-md-end">
              <p><strong>Created:</strong> <%= @invoice.created_at.strftime('%Y-%m-%d') %></p>
              <p><strong>Last Updated:</strong> <%= @invoice.updated_at.strftime('%Y-%m-%d') %></p>
            </div>
          </div>

          <div class="d-flex justify-content-between">
            <% if @invoice.status == 'pending' %>
              <%= link_to "Mark as Paid", edit_invoice_path(@invoice, invoice: { status: 'paid' }),
                          method: :get,
                          class: "btn btn-success" %>
            <% end %>

            <%= link_to "Delete Invoice", invoice_path(@invoice),
                        method: :delete,
                        data: { confirm: "Are you sure you want to delete this invoice?" },
                        class: "btn btn-outline-danger" %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
