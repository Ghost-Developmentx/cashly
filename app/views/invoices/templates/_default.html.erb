<!-- app/views/invoices/templates/_default.html.erb -->
<div class="invoice-template">
  <div class="invoice-header">
    <div class="row">
      <div class="col-6">
        <h1>INVOICE</h1>
        <h2>#<%= @invoice.generate_invoice_number %></h2>
      </div>
      <div class="col-6 text-end">
        <h3><%= @invoice.user.company_name || "Your Business" %></h3>
        <p>
          <%= @invoice.user.address_line1 %><br>
          <% if @invoice.user.address_line2.present? %>
            <%= @invoice.user.address_line2 %><br>
          <% end %>
          <%= @invoice.user.city %>, <%= @invoice.user.state %> <%= @invoice.user.zip_code %><br>
          <%= @invoice.user.country %><br>
          <%= @invoice.user.email %>
        </p>
      </div>
    </div>
  </div>

  <div class="invoice-details">
    <div class="row">
      <div class="col-6">
        <div class="invoice-to">
          <h4>INVOICE TO:</h4>
          <h5><%= @invoice.client_name %></h5>
          <% if @invoice.client_address.present? %>
            <p><%= simple_format(@invoice.client_address) %></p>
          <% end %>
          <p><%= @invoice.client_email %></p>
        </div>
      </div>
      <div class="col-6">
        <div class="invoice-info">
          <div class="row">
            <div class="col-6">
              <p><strong>Invoice Date:</strong></p>
              <p><strong>Due Date:</strong></p>
              <p><strong>Status:</strong></p>
            </div>
            <div class="col-6 text-end">
              <p><%= @invoice.issue_date&.strftime('%b %d, %Y') %></p>
              <p><%= @invoice.due_date&.strftime('%b %d, %Y') %></p>
              <p><span class="badge <%= @invoice.status == 'paid' ? 'bg-success' : (@invoice.status == 'pending' ? 'bg-warning' : 'bg-secondary') %>">
                <%= @invoice.status.upcase %>
              </span></p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="invoice-items">
    <table class="table">
      <thead>
      <tr>
        <th>Description</th>
        <th class="text-end">Amount</th>
      </tr>
      </thead>
      <tbody>
      <tr>
        <td>
          <% if @invoice.description.present? %>
            <%= @invoice.description %>
          <% else %>
            Professional Services
          <% end %>
        </td>
        <td class="text-end"><%= @invoice.formatted_currency %></td>
      </tr>
      </tbody>
      <tfoot>
      <tr>
        <td class="text-end"><strong>Total:</strong></td>
        <td class="text-end"><strong><%= @invoice.formatted_currency %></strong></td>
      </tr>
      </tfoot>
    </table>
  </div>

  <% if @invoice.notes.present? || @invoice.terms.present? %>
    <div class="invoice-notes">
      <% if @invoice.notes.present? %>
        <div class="notes-section">
          <h4>Notes</h4>
          <p><%= simple_format(@invoice.notes) %></p>
        </div>
      <% end %>

      <% if @invoice.terms.present? %>
        <div class="terms-section">
          <h4>Terms and Conditions</h4>
          <p><%= simple_format(@invoice.terms) %></p>
        </div>
      <% end %>
    </div>
  <% end %>

  <div class="invoice-footer">
    <p>Thank you for your business!</p>
    <% if @invoice.status == 'pending' && @invoice.stripe_invoice_id.present? %>
      <p>Pay this invoice securely online: <a href="https://invoice.stripe.com/i/<%= @invoice.stripe_invoice_id %>" target="_blank">https://invoice.stripe.com/i/<%= @invoice.stripe_invoice_id %></a></p>
    <% end %>
  </div>
</div>

<style>
    .invoice-template {
        padding: 30px;
        font-family: 'Arial', sans-serif;
        color: #333;
    }

    .invoice-header {
        margin-bottom: 40px;
    }

    .invoice-header h1 {
        color: #2c3e50;
        font-size: 28px;
        margin-bottom: 5px;
    }

    .invoice-header h2 {
        color: #7f8c8d;
        font-size: 20px;
        margin-top: 0;
    }

    .invoice-header h3 {
        color: #2c3e50;
        font-size: 22px;
    }

    .invoice-details {
        margin-bottom: 40px;
    }

    .invoice-to h4, .invoice-info h4 {
        color: #7f8c8d;
        font-size: 14px;
        margin-bottom: 10px;
    }

    .invoice-to h5 {
        font-size: 18px;
        margin-top: 0;
        margin-bottom: 10px;
    }

    .invoice-info {
        background-color: #f9f9f9;
        padding: 15px;
        border-radius: 5px;
    }

    .invoice-items {
        margin-bottom: 40px;
    }

    .invoice-items table {
        width: 100%;
    }

    .invoice-items th {
        background-color: #f9f9f9;
        border-bottom: 2px solid #ddd;
    }

    .invoice-items tfoot {
        border-top: 2px solid #ddd;
        font-size: 18px;
    }

    .invoice-notes {
        margin-bottom: 40px;
        padding: 20px;
        background-color: #f9f9f9;
        border-radius: 5px;
    }

    .invoice-notes h4 {
        color: #2c3e50;
        font-size: 16px;
        margin-bottom: 10px;
    }

    .invoice-footer {
        margin-top: 40px;
        text-align: center;
        color: #7f8c8d;
        font-size: 14px;
    }
</style>