<!-- app/views/invoices/templates/minimalist.html.erb -->
<div class="invoice-template minimalist">
  <div class="invoice-header">
    <div class="row">
      <div class="col-6">
        <% if defined?(@logo_data) && @logo_data.present? %>
          <div class="company-logo mb-4">
            <img src="data:image/jpeg;base64,<%= Base64.strict_encode64(@logo_data) %>" alt="Company Logo" class="logo-image">
          </div>
        <% end %>
        <h1>
          <% if @company_name_override.present? %>
            <%= @company_name_override %>
          <% elsif @invoice.user&.company_name.present? %>
            <%= @invoice.user.company_name %>
          <% else %>
            Your Business
          <% end %>
        </h1>
      </div>
      <div class="col-6 text-end">
        <h2>INVOICE</h2>
        <% if @invoice.id.present? %>
          <div class="invoice-number">#<%= @invoice.generate_invoice_number %></div>
        <% else %>
          <div class="invoice-number">#INV-00001</div>
        <% end %>
      </div>
    </div>
  </div>

  <hr class="divider">

  <div class="invoice-info">
    <div class="row">
      <div class="col-3">
        <div class="info-label">Date</div>
        <div class="info-value"><%= @invoice.issue_date&.strftime('%d/%m/%Y') %></div>
      </div>
      <div class="col-3">
        <div class="info-label">Due Date</div>
        <div class="info-value"><%= @invoice.due_date&.strftime('%d/%m/%Y') %></div>
      </div>
      <div class="col-3">
        <div class="info-label">Status</div>
        <div class="info-value status-<%= @invoice.status %>"><%= @invoice.status.upcase %></div>
      </div>
      <div class="col-3">
        <div class="info-label">Amount</div>
        <div class="info-value"><%= @invoice.formatted_currency %></div>
      </div>
    </div>
  </div>

  <div class="invoice-addresses">
    <div class="row">
      <div class="col-6">
        <div class="address-block from">
          <div class="address-label">FROM</div>
          <div class="address-content">
            <% if @company_name_override.present? %>
              <%= @company_name_override %><br>
            <% elsif @invoice.user&.company_name.present? %>
              <%= @invoice.user.company_name %><br>
            <% else %>
              Your Business<br>
            <% end %>

            <% if @invoice.user&.address_line1.present? %>
              <%= @invoice.user.address_line1 %><br>
              <% if @invoice.user&.address_line2.present? %>
                <%= @invoice.user.address_line2 %><br>
              <% end %>
              <%= @invoice.user.city %>, <%= @invoice.user.state %> <%= @invoice.user.zip_code %><br>
              <%= @invoice.user.country %><br>
            <% else %>
              123 Business Street<br>
              Cityville, ST 12345<br>
              Country<br>
            <% end %>
            <%= @invoice.user&.email || "your@email.com" %>
          </div>
        </div>
      </div>
      <div class="col-6">
        <div class="address-block to">
          <div class="address-label">TO</div>
          <div class="address-content">
            <%= @invoice.client_name %><br>
            <% if @invoice.client_address.present? %>
              <%= simple_format(@invoice.client_address.gsub("\n", "<br>")) %>
            <% end %>
            <%= @invoice.client_email %>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="invoice-details">
    <table class="table">
      <thead>
      <tr>
        <th>Description</th>
        <th class="text-end">Amount</th>
      </tr>
      </thead>
      <tbody>
      <tr>
        <td>
        </td>
        <td class="text-end"><%= @invoice.formatted_currency %></td>
      </tr>
      </tbody>
      <tfoot>
      <tr>
        <td class="text-end">Total</td>
        <td class="text-end"><strong><%= @invoice.formatted_currency %></strong></td>
      </tr>
      </tfoot>
    </table>
  </div>

  <% if @invoice.notes.present? %>
    <div class="invoice-notes">
      <div class="notes-label">Notes</div>
      <div class="notes-content">
        <%= simple_format(@invoice.notes) %>
      </div>
    </div>
  <% end %>

  <% if @invoice.terms.present? %>
    <div class="invoice-terms">
      <div class="terms-label">Terms</div>
      <div class="terms-content">
        <%= simple_format(@invoice.terms) %>
      </div>
    </div>
  <% end %>

  <div class="invoice-footer">
    <% if @invoice.status == 'pending' && @invoice.stripe_invoice_id.present? %>
      <div class="payment-link">
        Pay online: <a href="https://invoice.stripe.com/i/<%= @invoice.stripe_invoice_id %>">https://invoice.stripe.com/i/<%= @invoice.stripe_invoice_id %></a>
      </div>
    <% end %>
    <div class="thank-you">Thank you for your business</div>
  </div>
</div>

<style>
    .invoice-template.minimalist {
        padding: 50px;
        font-family: 'Helvetica Neue', Arial, sans-serif;
        color: #333;
        line-height: 1.5;
        max-width: 800px;
        margin: 0 auto;
    }

    .logo-image {
        max-height: 70px;
        max-width: 200px;
    }

    .invoice-header h1 {
        font-size: 24px;
        font-weight: 400;
        margin: 0;
        color: #000;
    }

    .invoice-header h2 {
        font-size: 28px;
        font-weight: 300;
        letter-spacing: 2px;
        margin: 0 0 5px 0;
        color: #000;
    }

    .invoice-number {
        font-size: 16px;
        color: #888;
    }

    .divider {
        margin: 30px 0;
        border: none;
        border-top: 1px solid #eee;
    }

    .invoice-info {
        margin-bottom: 40px;
    }

    .info-label {
        font-size: 12px;
        text-transform: uppercase;
        letter-spacing: 1px;
        color: #888;
        margin-bottom: 5px;
    }

    .info-value {
        font-size: 16px;
    }

    .info-value.status-paid {
        color: #4CAF50;
    }

    .info-value.status-pending {
        color: #FF9800;
    }

    .info-value.status-draft {
        color: #9E9E9E;
    }

    .address-label {
        font-size: 12px;
        text-transform: uppercase;
        letter-spacing: 1px;
        color: #888;
        margin-bottom: 10px;
    }

    .address-content {
        margin-bottom: 30px;
        font-size: 14px;
    }

    .invoice-addresses {
        margin-bottom: 40px;
    }

    .invoice-details {
        margin-bottom: 40px;
    }

    .invoice-details table {
        width: 100%;
        border-collapse: collapse;
    }

    .invoice-details thead th {
        border-bottom: 1px solid #eee;
        text-align: left;
        font-weight: 500;
        padding: 10px;
        font-size: 14px;
        text-transform: uppercase;
        letter-spacing: 1px;
        color: #888;
    }

    .invoice-details tbody td {
        padding: 15px 10px;
        border-bottom: 1px solid #eee;
    }

    .invoice-details tfoot td {
        padding: 15px 10px;
        font-size: 16px;
    }

    .invoice-notes, .invoice-terms {
        margin-bottom: 40px;
        font-size: 14px;
    }

    .notes-label, .terms-label {
        font-size: 12px;
        text-transform: uppercase;
        letter-spacing: 1px;
        color: #888;
        margin-bottom: 10px;
    }

    .invoice-footer {
        margin-top: 50px;
        text-align: center;
        color: #888;
        font-size: 14px;
    }

    .payment-link {
        margin-bottom: 15px;
    }

    .payment-link a {
        color: #2196F3;
        text-decoration: none;
    }

    .thank-you {
        font-style: italic;
    }
</style>