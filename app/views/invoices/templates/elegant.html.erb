<!-- app/views/invoices/templates/elegant.html.erb -->
<div class="invoice-template elegant">
  <div class="invoice-header">
    <div class="row">
      <div class="col-6">
        <% if defined?(@logo_data) && @logo_data.present? %>
          <div class="company-logo">
            <img src="data:image/jpeg;base64,<%= Base64.strict_encode64(@logo_data) %>" alt="Company Logo" class="logo-image">
          </div>
        <% else %>
          <div class="company-initial">
            <% if @company_name_override.present? %>
              <%= @company_name_override.first(1) %>
            <% elsif @invoice.user&.company_name.present? %>
              <%= @invoice.user.company_name.first(1) %>
            <% else %>
              C
            <% end %>
          </div>
        <% end %>
        <h2 class="company-name">
          <% if @company_name_override.present? %>
            <%= @company_name_override %>
          <% elsif @invoice.user&.company_name.present? %>
            <%= @invoice.user.company_name %>
          <% else %>
            Your Business
          <% end %>
        </h2>
      </div>
      <div class="col-6">
        <div class="invoice-info">
          <h1>INVOICE</h1>
          <% if @invoice.id.present? %>
            <div class="invoice-number">#<%= @invoice.generate_invoice_number %></div>
          <% else %>
            <div class="invoice-number">#INV-00001</div>
          <% end %>
          <div class="invoice-dates">
            <div class="date-item">
              <span class="date-label">Date Issued:</span>
              <span class="date-value"><%= @invoice.issue_date&.strftime('%b %d, %Y') %></span>
            </div>
            <div class="date-item">
              <span class="date-label">Due Date:</span>
              <span class="date-value"><%= @invoice.due_date&.strftime('%b %d, %Y') %></span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="status-stripe">
    <div class="status-content">
      <span class="status-label">Status:</span>
      <span class="status-badge <%= @invoice.status %>"><%= @invoice.status.upcase %></span>
    </div>
  </div>

  <div class="invoice-body">
    <div class="invoice-addresses">
      <div class="row">
        <div class="col-6">
          <div class="address-block">
            <h3 class="address-title">From</h3>
            <div class="address-content">
              <% if @company_name_override.present? %>
                <div class="name"><%= @company_name_override %></div>
              <% elsif @invoice.user&.company_name.present? %>
                <div class="name"><%= @invoice.user.company_name %></div>
              <% else %>
                <div class="name">Your Business</div>
              <% end %>

              <% if @invoice.user&.address_line1.present? %>
                <div class="address">
                  <%= @invoice.user.address_line1 %><br>
                  <% if @invoice.user&.address_line2.present? %>
                    <%= @invoice.user.address_line2 %><br>
                  <% end %>
                  <%= @invoice.user.city %>, <%= @invoice.user.state %> <%= @invoice.user.zip_code %><br>
                  <%= @invoice.user.country %>
                </div>
              <% else %>
                <div class="address">
                  123 Business Street<br>
                  Cityville, ST 12345<br>
                  Country
                </div>
              <% end %>

              <div class="email"><%= @invoice.user&.email || "your@email.com" %></div>
            </div>
          </div>
        </div>
        <div class="col-6">
          <div class="address-block">
            <h3 class="address-title">To</h3>
            <div class="address-content">
              <div class="name"><%= @invoice.client_name %></div>
              <% if @invoice.client_address.present? %>
                <div class="address">
                  <%= simple_format(@invoice.client_address) %>
                </div>
              <% end %>
              <div class="email"><%= @invoice.client_email %></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="invoice-table-container">
      <table class="invoice-table">
        <thead>
        <tr>
          <th>Description</th>
          <th class="text-end">Amount</th>
        </tr>
        </thead>
        <tbody>
        <tr>
          <td>
          </td>
          <td class="text-end amount"><%= @invoice.formatted_currency %></td>
        </tr>
        </tbody>
        <tfoot>
        <tr>
          <td class="text-end">Total</td>
          <td class="text-end amount"><%= @invoice.formatted_currency %></td>
        </tr>
        <% if @invoice.status == 'paid' %>
          <tr>
            <td class="text-end">Amount Paid</td>
            <td class="text-end amount paid"><%= @invoice.formatted_currency %></td>
          </tr>
          <tr>
            <td class="text-end">Balance Due</td>
            <td class="text-end amount">$0.00</td>
          </tr>
        <% else %>
          <tr>
            <td class="text-end">Balance Due</td>
            <td class="text-end amount due"><%= @invoice.formatted_currency %></td>
          </tr>
        <% end %>
        </tfoot>
      </table>
    </div>

    <div class="invoice-notes-terms">
      <div class="row">
        <% if @invoice.notes.present? %>
          <div class="col-md-6">
            <div class="notes-section">
              <h3 class="section-title">Notes</h3>
              <div class="section-content">
                <%= simple_format(@invoice.notes) %>
              </div>
            </div>
          </div>
        <% end %>

        <% if @invoice.terms.present? %>
          <div class="col-md-<%= @invoice.notes.present? ? '6' : '12' %>">
            <div class="terms-section">
              <h3 class="section-title">Terms and Conditions</h3>
              <div class="section-content">
                <%= simple_format(@invoice.terms) %>
              </div>
            </div>
          </div>
        <% end %>
      </div>
    </div>

    <% if @invoice.status == 'pending' && @invoice.stripe_invoice_id.present? %>
      <div class="payment-section">
        <h3 class="section-title">Payment Information</h3>
        <p>Pay this invoice securely online using the link below:</p>
        <a href="https://invoice.stripe.com/i/<%= @invoice.stripe_invoice_id %>" class="payment-button">
          Pay Invoice Now
        </a>
      </div>
    <% end %>
  </div>

  <div class="invoice-footer">
    <div class="thank-you">Thank you for your business!</div>
    <div class="footer-info">
      <% if @company_name_override.present? %>
        <%= @company_name_override %> •
      <% elsif @invoice.user&.company_name.present? %>
        <%= @invoice.user.company_name %> •
      <% else %>
        Your Business •
      <% end %>
      <%= @invoice.user&.email || "your@email.com" %>
    </div>
  </div>
</div>

<style>
    .invoice-template.elegant {
        font-family: 'Playfair Display', Georgia, serif;
        color: #283252;
        background-color: white;
        padding: 40px;
        max-width: 850px;
        margin: 0 auto;
        font-size: 14px;
        line-height: 1.6;
    }

    .invoice-header {
        margin-bottom: 20px;
    }

    .company-logo {
        margin-bottom: 20px;
    }

    .logo-image {
        max-height: 80px;
        max-width: 200px;
    }

    .company-initial {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 70px;
        height: 70px;
        border-radius: 50%;
        background: #283252;
        color: white;
        font-size: 32px;
        font-weight: 600;
        margin-bottom: 20px;
    }

    .company-name {
        font-family: 'Playfair Display', Georgia, serif;
        font-size: 24px;
        font-weight: 700;
        color: #283252;
        margin-bottom: 10px;
    }

    .invoice-info {
        text-align: right;
    }

    .invoice-info h1 {
        font-family: 'Playfair Display', Georgia, serif;
        font-size: 32px;
        font-weight: 700;
        color: #283252;
        margin-bottom: 5px;
    }

    .invoice-number {
        font-size: 18px;
        font-weight: 600;
        color: #6e7891;
        margin-bottom: 15px;
    }

    .invoice-dates {
        color: #6e7891;
    }

    .date-item {
        margin-bottom: 5px;
    }

    .date-label {
        font-weight: 600;
        margin-right: 10px;
    }

    .status-stripe {
        background: #f5f7fa;
        padding: 15px 40px;
        margin: 0 -40px 30px;
    }

    .status-content {
        display: flex;
        align-items: center;
    }

    .status-label {
        font-weight: 600;
        margin-right: 10px;
    }

    .status-badge {
        display: inline-block;
        padding: 6px 15px;
        border-radius: 30px;
        font-size: 12px;
        font-weight: 600;
        letter-spacing: 1px;
    }

    .status-badge.paid {
        background-color: #e3f8ec;
        color: #0ca36e;
    }

    .status-badge.pending {
        background-color: #fff3cd;
        color: #8a6d3b;
    }

    .status-badge.draft {
        background-color: #e9ecef;
        color: #6c757d;
    }

    .invoice-body {
        margin-bottom: 40px;
    }

    .invoice-addresses {
        margin-bottom: 40px;
    }

    .address-title {
        font-family: 'Playfair Display', Georgia, serif;
        font-size: 20px;
        font-weight: 700;
        color: #283252;
        margin-bottom: 15px;
        position: relative;
        padding-bottom: 10px;
    }

    .address-title:after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 0;
        width: 40px;
        height: 2px;
        background: #283252;
    }

    .address-content {
        color: #6e7891;
    }

    .address-content .name {
        font-weight: 600;
        margin-bottom: 5px;
    }

    .address-content .address {
        margin-bottom: 5px;
    }

    .invoice-table-container {
        margin-bottom: 40px;
    }

    .invoice-table {
        width: 100%;
        border-collapse: collapse;
    }

    .invoice-table th {
        font-family: 'Playfair Display', Georgia, serif;
        text-align: left;
        padding: 15px;
        border-bottom: 2px solid #283252;
        font-weight: 700;
        color: #283252;
    }

    .invoice-table td {
        padding: 15px;
        border-bottom: 1px solid #e9ecef;
    }

    .invoice-table tfoot td {
        padding: 15px;
        font-weight: 600;
    }

    .invoice-table .amount {
        font-weight: 700;
    }

    .invoice-table .amount.paid {
        color: #0ca36e;
    }

    .invoice-table .amount.due {
        color: #283252;
    }

    .invoice-notes-terms {
        margin-bottom: 40px;
    }

    .section-title {
        font-family: 'Playfair Display', Georgia, serif;
        font-size: 18px;
        font-weight: 700;
        color: #283252;
        margin-bottom: 15px;
        position: relative;
        padding-bottom: 10px;
    }

    .section-title:after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 0;
        width: 40px;
        height: 2px;
        background: #283252;
    }

    .section-content {
        color: #6e7891;
    }

    .payment-section {
        background: #f5f7fa;
        padding: 30px;
        border-radius: 5px;
        text-align: center;
        margin-top: 40px;
    }

    .payment-section .section-title {
        text-align: center;
        margin-bottom: 20px;
    }

    .payment-section .section-title:after {
        left: 50%;
        transform: translateX(-50%);
    }

    .payment-button {
        display: inline-block;
        background: #283252;
        color: white;
        padding: 12px 30px;
        border-radius: 5px;
        text-decoration: none;
        font-weight: 600;
        margin-top: 15px;
        transition: background 0.3s;
    }

    .payment-button:hover {
        background: #1c2440;
        color: white;
    }

    .invoice-footer {
        text-align: center;
        color: #6e7891;
        margin-top: 60px;
        padding-top: 20px;
        border-top: 1px solid #e9ecef;
    }

    .thank-you {
        font-family: 'Playfair Display', Georgia, serif;
        font-size: 18px;
        font-weight: 700;
        color: #283252;
        margin-bottom: 10px;
    }

    .footer-info {
        font-size: 12px;
    }
</style>